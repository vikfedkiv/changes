name: CI/CD

on:
  pull_request:
    branches: [ main ]

jobs:
  frontend_test:
    runs-on: self-hosted
    steps:
      - name: Frontend changes ðŸš—
        uses: dorny/paths-filter@v2
        id: filter
        with:
          filters: |
            frontend:
              - 'package.json'
              - 'yarn.lock'
              - '**/*.js'
              - '**/*.ts'
              - '**/*.html'
              - '**/*.css'
              - '**/*.scss'
              - '*.yml'
              - '.github/workflows/*.yml'
              - '**/*.json'
              - '**/*.sh'
            exclude:
              - 'tests/Cypress/**/*.po.ts'
              - 'tests/Cypress/**/*.host.ts'
              - 'tests/Cypress/**/*.spec.ts'
      - name: Run Frontend test ðŸš—
        if: steps.filter.outputs.frontend == 'true' && steps.filter.outputs.exclude != 'true'
        run: |
            echo "Run Frontend test"

  e2e_cypress:
    runs-on: self-hosted
    steps:
      - name: Cypress changes ðŸš—
        uses: dorny/paths-filter@v2
        id: filter
        with:
          filters: |
            frontend:
              - 'package.json'
              - 'yarn.lock'
              - '**/*.js'
              - '**/*.ts'
              - '**/*.html'
              - '**/*.css'
              - '**/*.scss'
              - '*.yml'
              - '.github/workflows/*.yml'
              - '**/*.json'
              - '**/*.sh'
            exclude:
              - 'resources/assets/**/*.po.ts'
              - 'resources/assets/**/*.host.ts'
              - 'resources/assets/**/*.spec.ts'
      - name: Run E2E Cypress test ðŸš—
        if: steps.filter.outputs.frontend == 'true' && steps.filter.outputs.exclude != 'true'
        run: |
            echo "Run E2E Cypress test"

